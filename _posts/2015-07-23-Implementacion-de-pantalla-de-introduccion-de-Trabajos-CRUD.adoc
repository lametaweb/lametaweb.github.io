= Implementación de pantalla de introducción de Trabajos (CRUD).
La metaweb
:hp-tags: JSF, JavaServer Faces, CRUD, EJB, Hibernate, backing bean, Git, GitHub
:published_at: 2015-07-23

En este post os resumo los aspectos más relevantes de la implementación del caso de uso de introducción de Trabajos de Drones creado a partir de la solicitud de dicha funcionalidad por parte de nuestro cliente imaginario, TAS. La release de la que se parte es la 1.0.1, y a la que llegaremos será la 1.1.x. Así que usad la primera para intertar implementar la pantalla por vuestra cuenta y la segunda para ver la impleme tación terminada.

Yo aquí os haré una serie de comentarios sobre la release 1.1.x, señalando los detalles de implementación interesantes. Pero primero una breve introducción sobré qué es un mantenimiento de una entidad del modelo de dominio. En inglés se conoce como CRUD: Create, Read/Retrieve, Update, Delete, y se refiere al conjunto de elementos de diseño y programa necesarios para implementar el típico mantenimiento de una entidad. El caso más sencillo se da cuando la entidad es una entidad "hoja" en nuestro diagrama de clases. Si la entidad tiene una o más relaciones con otras entidades tendremos, en ocasiones, que mantenerlas también en el CRUD. Recordemos nuestro sencillo diagrama de clases:

image::https://raw.githubusercontent.com/lametaweb/lametaweb.github.io/master/images/003/post003-fig045.png[]

¿Qué mantenimientos podríamos hacer aquí? Bueno, en este caso tienen sentido dos mantenimientos. El que vamos a implementar, de la entidad Trabajo, donde tendremos que mantener la relación desde Trabajo hacia Drone, que representa la selección del drone que va a llevar a cabo el trabajo, y la relación del trabajo con sus puntos de ruta, que representa la ruta que seguirá el drone en ese trabajo. Y por otro lado también cabe realizar un CRUD de la entidad Drone donde no cabe el mantenimiento de la relación desde Drone a Trabajo ya que cuando por ejemplo creamos un drone no tiene sentido en nuestro caso asignarle en el mismo caso o en otro diferente uno o más trabajos.

Centrándonos en el mantenimiento de la entidad Trabajo empecemos con su resolución. Por partes, hacemos primero un análisis, luego el diseño de la interfaz y por último vemos la implementación de cada capa.

La lista de requisitos extraida de la entrevista con el cliente es la siguiente:

.Lista de requisitos del mantenimiento de trabajos
[width="90%"]
|===
|[small]*Pantalla de listado de trabajos*
|[small]#Inicialmente se presentará un listado de trabajos en pantalla.#
|[small]#El listado se debe ordenar por todos sus campos y se presentará paginado.#
|[small]#Sobre el listado dispondremos de comandos para Editar, dar de baja y dar de baja definitiva un trabajo.#
|[small]#La baja definitiva debe ser confirmada.#
|[small]*Pantalla de mantenimiento de trabajo*
|[small]#Todos los campos se validarán presentando mensajes adecuados.#
|[small]#Se presentará un listado de los drones disponibles según la fecha del trabajo.#
|[small]#La ruta se importará desde un excel generado por la aplicación de gestión de mapas usada para la definición de rutas sobre mapa.#
|===

Posteriormente a la definición de los requisitos decidimos si usar o no una librería JSF específica que nos aporte capacidades adicionales en la capa de presentación. Nuestras pantallas usarán listados con capacidades de ordenación, paginación, etc. Además necesitamos acciones con confirmación. El coste de incluir la librería es muy bajo y finalmente optamos por incluir una en nuestro proyecto. Entre RichFaces y Primefaces elegimos la segunda. 






